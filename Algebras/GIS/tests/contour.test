#
# Tests for the contour operator of the GIS Algebra
#

################################################################################
# Create Test Fixtures #########################################################
################################################################################

#setup gis2test

create database gis2test;
open database gis2test;

let sint1 = ([const sint value ((1.0 1.0 1.0)(3 3)(0 0 (90 91 92 114 115 116 132 133 134)))])

let sint2 = ([const sint value ((1.0 1.0 1.0)(3 3)(0 0 (90 103 118 92 105 116 95 102 114)))])

let sint3 = ([const sint value ((0.0 0.0 3.0)(3 3)(0 0 (100 99 98 102 101 106 177 103 109)))])

let test1 = ([const sint value ((0.0 0.0 1.0)(5 5)(0 0 (12 13 14 15 16 21 23 34 38 40 20 undefined 32 40 50 30 20 10 0 -10 35 30 40 50 30)))])

let test2 = ([const sint value ((1.0 1.0 1.0)(6 6)(0 0 (12 13 14 23 34 45 15 16 18 20 24 36 8 7 10 12 34 44 10 12 14 20 22 26 18 20 24 30 32 34 14 16 8 16 29 30)))])

let test3 = ([const sint value ((1.0 1.0 1.0)(6 6)(0 0 (12 13 14 23 34 45 15 16 18 20 24 36 8 7 10 undefined 34 44 10 12 14 20 22 26 18 20 24 30 32 34 14 16 8 16 29 30)))])

################################################################################
# Run Tests ####################################################################
################################################################################

#testcase query contourlines for 3x3 waagerecht
#yields ((rel (tuple ((Height int)(Contour line))))((132 ((1.0 4.0 1.5 4.0)(1.5 4.0 2.5 3.9166666666666665)(2.5 3.9166666666666665 4.0 3.833333333333333)))(130 ((1.0 3.833333333333333 1.5 3.833333333333333)(1.5 3.833333333333333 2.5 3.75)(2.5 3.75 4.0 3.6666666666666665)))(128 ((1.0 3.6666666666666665 1.5 3.6666666666666665)(1.5 3.6666666666666665 2.5 3.5833333333333335)(2.5 3.5833333333333335 4.0 3.5)))(126 ((1.0 3.5 1.5 3.5)(1.5 3.5 2.5 3.416666666666667)(2.5 3.416666666666667 4.0 3.3333333333333335)))(124 ((1.0 3.3333333333333335 1.5 3.3333333333333335)(1.5 3.3333333333333335 2.5 3.25)(2.5 3.25 4.0 3.1666666666666665)))(122 ((1.0 3.1666666666666665 1.5 3.1666666666666665)(1.5 3.1666666666666665 2.5 3.0833333333333335)(2.5 3.0833333333333335 4.0 3.0)))(120 ((1.0 3.0 1.5 3.0)(1.5 3.0 2.5 2.9166666666666665)(2.5 2.9166666666666665 4.0 2.8333333333333335)))(118 ((1.0 2.8333333333333335 1.5 2.8333333333333335)(1.5 2.8333333333333335 2.5 2.75)(2.5 2.75 4.0 2.6666666666666665)))(116 ((1.0 2.6666666666666665 1.5 2.6666666666666665)(1.5 2.6666666666666665 2.5 2.5833333333333335)(2.5 2.5833333333333335 4.0 2.5)))(114 ((1.0 2.5 1.5 2.5)(1.5 2.5 2.5 2.4375)(2.5 2.4375 4.0 2.375)))(112 ((1.0 2.375 1.5 2.375)(1.5 2.375 2.5 2.3125)(2.5 2.3125 4.0 2.25)))(110 ((1.0 2.25 1.5 2.25)(1.5 2.25 2.5 2.1875)(2.5 2.1875 4.0 2.125)))(108 ((1.0 2.125 1.5 2.125)(1.5 2.125 2.5 2.0625)(2.5 2.0625 4.0 2.0)))(106 ((1.0 2.0 1.5 2.0)(1.5 2.0 2.5 1.9375)(2.5 1.9375 4.0 1.875)))(104 ((1.0 1.875 1.5 1.875)(1.5 1.875 2.5 1.8125)(2.5 1.8125 4.0 1.75)))(102 ((1.0 1.75 1.5 1.75)(1.5 1.75 2.5 1.6875)(2.5 1.6875 4.0 1.625)))(100 ((1.0 1.625 1.5 1.625)(1.5 1.625 2.5 1.5625)(2.5 1.5625 4.0 1.5)))(98 ((1.0 1.5 1.5 1.5)(1.5 1.5 2.5 1.4375)(2.5 1.4375 4.0 1.375)))(96 ((1.0 1.375 1.5 1.375)(1.5 1.375 2.5 1.3125)(2.5 1.3125 4.0 1.25)))(94 ((1.0 1.25 1.5 1.25)(1.5 1.25 2.5 1.1875)(2.5 1.1875 4.0 1.125)))(92 ((1.0 1.125 1.5 1.125)(1.5 1.125 2.5 1.0625)(2.5 1.0625 4.0 1.0)))))
query contourlines(sint1,2) consume

#testcase query contourlines for 3x3 senkrecht
#yields ((rel (tuple ((Height int)(Contour line))))((116 ((3.8 1.0 4.0 2.5)))(114 ((3.6 1.0 3.7272727272727275 2.5)(3.7272727272727275 2.5 4.0 4.0)))(112 ((3.4 1.0 3.4545454545454546 2.5)(3.4545454545454546 2.5 3.75 4.0)))(110 ((3.1818181818181817 2.5 3.2 1.0)(3.1818181818181817 2.5 3.5 4.0)))(108 ((2.909090909090909 2.5 3.0 1.0)(2.909090909090909 2.5 3.25 4.0)))(106 ((2.6363636363636362 2.5 2.8 1.0)(2.6363636363636362 2.5 3.0 4.0)))(104 ((2.4230769230769234 2.5 2.5 1.75)(2.4230769230769234 2.5 2.5 3.0)(2.5 1.75 2.6 1.0)(2.5 3.0 2.75 4.0)))(102 ((2.269230769230769 2.5 2.4230769230769234 1.0)(2.269230769230769 2.5 2.5 4.0)))(100 ((2.1153846153846154 2.5 2.269230769230769 1.0)(2.1153846153846154 2.5 2.2142857142857144 4.0)))(98 ((1.9285714285714286 4.0 1.9615384615384617 2.5)(1.9615384615384617 2.5 2.1153846153846154 1.0)))(96 ((1.6428571428571428 4.0 1.8076923076923077 2.5)(1.8076923076923077 2.5 1.9615384615384617 1.0)))(94 ((1.0 3.5 1.5 3.5)(1.5 3.5 1.6538461538461537 2.5)(1.6538461538461537 2.5 1.8076923076923077 1.0)))(92 ((1.0 2.5 1.5 2.5)(1.5 2.5 1.6538461538461537 1.0)))))
query contourlines(sint2,2) consume

#testcase query contourlines for 3x3 
#yields ((rel (tuple ((Height int)(Contour line))))((176 ((0.0 8.94 1.5 8.94)(1.5 8.94 1.5405405405405403 9.0)))(174 ((0.0 8.82 1.5 8.82)(1.5 8.82 1.6216216216216217 9.0)))(172 ((0.0 8.7 1.5 8.7)(1.5 8.7 1.7027027027027026 9.0)))(170 ((0.0 8.58 1.5 8.58)(1.5 8.58 1.7837837837837838 9.0)))(168 ((0.0 8.46 1.5 8.46)(1.5 8.46 1.864864864864865 9.0)))(166 ((0.0 8.34 1.5 8.34)(1.5 8.34 1.945945945945946 9.0)))(164 ((0.0 8.22 1.5 8.22)(1.5 8.22 2.027027027027027 9.0)))(162 ((0.0 8.1 1.5 8.1)(1.5 8.1 2.1081081081081083 9.0)))(160 ((0.0 7.9799999999999995 1.5 7.9799999999999995)(1.5 7.9799999999999995 2.189189189189189 9.0)))(158 ((0.0 7.86 1.5 7.86)(1.5 7.86 2.27027027027027 9.0)))(156 ((0.0 7.74 1.5 7.74)(1.5 7.74 2.3513513513513513 9.0)))(154 ((0.0 7.62 1.5 7.62)(1.5 7.62 2.4324324324324325 9.0)))(152 ((0.0 7.5 1.5 7.5)(1.5 7.5 2.5135135135135136 9.0)))(150 ((0.0 7.38 1.5 7.38)(1.5 7.38 2.5945945945945947 9.0)))(148 ((0.0 7.26 1.5 7.26)(1.5 7.26 2.6756756756756754 9.0)))(146 ((0.0 7.14 1.5 7.14)(1.5 7.14 2.756756756756757 9.0)))(144 ((0.0 7.0200000000000005 1.5 7.0200000000000005)(1.5 7.0200000000000005 2.8378378378378377 9.0)))(142 ((0.0 6.9 1.5 6.9)(1.5 6.9 2.9189189189189193 9.0)))(140 ((0.0 6.78 1.5 6.78)(1.5 6.78 3.0 9.0)))(138 ((0.0 6.66 1.5 6.66)(1.5 6.66 3.081081081081081 9.0)))(136 ((0.0 6.54 1.5 6.54)(1.5 6.54 3.1621621621621623 9.0)))(134 ((0.0 6.42 1.5 6.42)(1.5 6.42 3.2432432432432434 9.0)))(132 ((0.0 6.3 1.5 6.3)(1.5 6.3 3.3243243243243246 9.0)))(130 ((0.0 6.18 1.5 6.18)(1.5 6.18 3.4054054054054053 9.0)))(128 ((0.0 6.0600000000000005 1.5 6.0600000000000005)(1.5 6.0600000000000005 3.4864864864864864 9.0)))(126 ((0.0 5.94 1.5 5.94)(1.5 5.94 3.5675675675675675 9.0)))(124 ((0.0 5.82 1.5 5.82)(1.5 5.82 3.6486486486486487 9.0)))(122 ((0.0 5.7 1.5 5.7)(1.5 5.7 3.72972972972973 9.0)))(120 ((0.0 5.58 1.5 5.58)(1.5 5.58 3.810810810810811 9.0)))(118 ((0.0 5.46 1.5 5.46)(1.5 5.46 3.8918918918918917 9.0)))(116 ((0.0 5.34 1.5 5.34)(1.5 5.34 3.972972972972973 9.0)))(114 ((0.0 5.22 1.5 5.22)(1.5 5.22 4.054054054054054 9.0)))(112 ((0.0 5.1 1.5 5.1)(1.5 5.1 4.135135135135135 9.0)))(110 ((0.0 4.98 1.5 4.98)(1.5 4.98 4.216216216216216 9.0)))(108 ((0.0 4.86 1.5 4.86)(1.5 4.86 4.297297297297297 9.0)(8.25 9.0 9.0 7.5)))(106 ((0.0 4.74 1.5 4.74)(1.5 4.74 4.378378378378378 9.0)(6.75 9.0 9.0 4.5)))(104 ((0.0 4.62 1.5 4.62)(1.5 4.62 4.45945945945946 9.0)(5.25 9.0 7.2 4.5)(7.2 4.5 9.0 3.375)))(102 ((0.0 4.5 1.5 4.5)(1.5 4.5 4.5 6.75)(4.5 6.75 5.4 4.5)(5.4 4.5 9.0 2.25)))(100 ((1.5 0.0 4.5 2.25)(4.5 2.25 9.0 1.125)))))
query contourlines(sint3,2) consume

#testcase query contourlines for 5x5 with hole and minus values
#yields ((rel (tuple ((Height int)(Contour line))))((48 ((3.3 5.0 3.5 4.9399999999999995)(3.5 4.9399999999999995 3.65 5.0)(4.7 2.5 5.0 2.3)(4.7 2.5 5.0 2.533333333333333)))(46 ((3.1 5.0 3.5 4.88)(3.5 4.88 3.8 5.0)(4.4 2.5 5.0 2.1)(4.4 2.5 5.0 2.5666666666666664)))(44 ((2.9 5.0 3.5 4.82)(3.5 4.82 3.95 5.0)(4.1 2.5 5.0 1.9)(4.1 2.5 5.0 2.6)))(42 ((2.7 5.0 3.5 4.76)(3.5 4.76 4.1 5.0)(3.8 2.5 5.0 1.7)(3.8 2.5 5.0 2.6333333333333333)))(40 ((2.5 5.0 3.5 4.7)(3.5 2.5 5.0 1.5)(3.5 2.5 5.0 2.6666666666666665)(3.5 4.7 4.25 5.0)))(38 ((2.3 5.0 2.5 4.9)(2.5 4.9 3.5 4.64)(3.25 2.5 3.5 1.5)(3.25 2.5 3.5 2.55)(3.5 1.5 5.0 1.375)(3.5 2.55 5.0 2.7)(3.5 4.64 4.4 5.0)))(36 ((2.1 5.0 2.5 4.8)(2.5 4.8 3.5 4.58)(3.0 1.5 3.5 1.3695652173913042)(3.0 1.5 3.0 2.5)(3.0 2.5 3.5 2.6)(3.5 1.3695652173913042 5.0 1.25)(3.5 2.6 5.0 2.7333333333333334)(3.5 4.58 4.55 5.0)))(34 ((0.0 4.7 0.5 4.7)(0.5 4.7 0.7 5.0)(1.9 5.0 2.5 4.7)(2.5 1.5 3.5 1.2391304347826086)(2.5 1.5 2.75 2.5)(2.5 4.7 3.5 4.5200000000000005)(2.75 2.5 3.5 2.65)(3.5 1.2391304347826086 5.0 1.125)(3.5 2.65 5.0 2.7666666666666666)(3.5 4.5200000000000005 4.7 5.0)))(32 ((0.0 4.1 0.5 4.1)(0.5 4.1 1.1 5.0)(1.7 5.0 2.5 4.6)(2.0 2.5 2.5 2.5)(2.3181818181818183 1.5 2.5 1.35)(2.3181818181818183 1.5 2.35 2.0)(2.35 2.0 2.5 2.5)(2.5 1.35 3.5 1.108695652173913)(2.5 2.5 3.5 2.7)(2.5 4.6 3.5 4.46)(3.5 1.108695652173913 5.0 1.0)(3.5 2.7 5.0 2.8)(3.5 4.46 4.85 5.0)))(30 ((0.0 3.5 0.5 3.5)(0.5 3.5 1.5 5.0)(1.5 5.0 2.5 4.5)(2.0 2.071428571428571 2.05 2.0)(2.0 2.588235294117647 2.5 2.590909090909091)(2.05 2.0 2.1363636363636362 1.5)(2.1363636363636362 1.5 2.5 1.2000000000000002)(2.5 1.2000000000000002 3.5 0.9782608695652174)(2.5 2.590909090909091 3.5 2.75)(2.5 4.5 3.5 4.4)(3.5 0.9782608695652174 5.0 0.875)(3.5 2.75 5.0 2.8333333333333335)(3.5 4.4 5.0 5.0)))(28 ((0.0 3.3 0.5 3.3)(0.7 3.5 1.5 4.7)(1.5 4.7 2.5 4.4)(1.875 2.0 1.9545454545454546 1.5)(1.9545454545454546 1.5 2.5 1.0499999999999998)(2.0 2.6764705882352944 2.5 2.6818181818181817)(2.5 1.0499999999999998 3.5 0.8478260869565217)(2.5 2.6818181818181817 3.5 2.8)(2.5 4.4 3.5 4.34)(3.5 0.8478260869565217 5.0 0.75)(3.5 2.8 5.0 2.8666666666666667)(3.5 4.34 5.0 4.925)))(26 ((0.0 3.1 0.5 3.1)(0.9 3.5 1.5 4.4)(1.5 4.4 2.5 4.3)(1.7249999999999999 2.0 1.7727272727272727 1.5)(1.7727272727272727 1.5 2.5 0.8999999999999999)(2.0 2.764705882352941 2.5 2.772727272727273)(2.5 0.8999999999999999 3.5 0.7173913043478262)(2.5 2.7727272727272725 3.5 2.85)(2.5 4.3 3.5 4.28)(3.5 0.7173913043478262 5.0 0.625)(3.5 2.85 5.0 2.9)(3.5 4.28 5.0 4.85)))(24 ((1.1 3.5 1.5 4.1)(1.5 4.1 2.5 4.2)(1.575 2.0 1.5909090909090908 1.5)(1.5909090909090908 1.5 2.5 0.75)(2.0 2.8529411764705883 2.5 2.8636363636363638)(2.5 0.75 3.5 0.5869565217391305)(2.5 2.8636363636363638 3.5 2.9)(2.5 4.2 3.5 4.22)(3.5 0.5869565217391305 5.0 0.5)(3.5 2.9 5.0 2.9333333333333336)(3.5 4.22 5.0 4.775)))(22 ((1.0 1.5 1.5 1.35)(1.0 1.5 1.2000000000000002 2.0)(1.3 3.5 1.5 3.8)(1.5 1.35 2.5 0.6000000000000001)(1.5 3.8 2.5 4.1)(2.0 2.9411764705882355 2.5 2.9545454545454546)(2.5 0.6000000000000001 3.5 0.4565217391304348)(2.5 2.9545454545454546 3.5 2.95)(2.5 4.1 3.5 4.16)(3.5 0.4565217391304348 5.0 0.375)(3.5 2.95 5.0 2.966666666666667)(3.5 4.16 5.0 4.7)))(20 ((0.0 1.3333333333333333 0.5 1.3333333333333333)(0.0 2.5 0.5 2.5)(0.5 1.3333333333333333 1.5 1.0499999999999998)(0.5 2.5 1.0 2.5)(1.5 1.0499999999999998 2.5 0.44999999999999996)(1.5 3.0 2.0 3.058823529411765)(1.5 3.5 2.0 3.058823529411765)(1.5 3.5 2.5 4.0)(2.0 3.058823529411765 2.5 3.0454545454545454)(2.5 0.44999999999999996 3.5 0.32608695652173914)(2.5 3.0454545454545454 3.5 3.0)(2.5 4.0 3.5 4.1)(3.5 0.32608695652173914 5.0 0.25)(3.5 3.0 5.0 3.0)(3.5 4.1 5.0 4.625)))(18 ((0.0 1.0 0.5 1.0)(0.5 1.0 1.5 0.75)(1.5 0.75 2.5 0.30000000000000004)(1.7 3.5 2.0 3.235294117647059)(1.7 3.5 2.5 3.9)(2.0 3.235294117647059 2.5 3.1363636363636362)(2.5 0.30000000000000004 3.5 0.19565217391304346)(2.5 3.1363636363636362 3.5 3.05)(2.5 3.9 3.5 4.04)(3.5 0.19565217391304346 5.0 0.125)(3.5 3.05 5.0 3.033333333333333)(3.5 4.04 5.0 4.55)))(16 ((0.0 0.6666666666666666 0.5 0.6666666666666666)(0.5 0.6666666666666666 1.5 0.44999999999999996)(1.5 0.44999999999999996 2.5 0.15000000000000002)(1.9 3.5 2.0 3.411764705882353)(1.9 3.5 2.5 3.8)(2.0 3.411764705882353 2.5 3.2272727272727275)(2.5 0.15000000000000002 3.5 0.06521739130434782)(2.5 3.2272727272727275 3.5 3.1)(2.5 3.8 3.5 3.98)(3.5 0.06521739130434782 5.0 0.0)(3.5 3.1 5.0 3.0666666666666664)(3.5 3.98 5.0 4.475)))(14 ((0.0 0.3333333333333333 0.5 0.3333333333333333)(0.5 0.3333333333333333 1.5 0.15000000000000002)(1.5 0.15000000000000002 2.5 0.0)(2.1 3.5 2.5 3.3181818181818183)(2.1 3.5 2.5 3.7)(2.5 3.3181818181818183 3.5 3.15)(2.5 3.7 3.5 3.92)(3.5 3.15 5.0 3.1)(3.5 3.92 5.0 4.4)))(12 ((2.3 3.5 2.5 3.409090909090909)(2.3 3.5 2.5 3.6)(2.5 3.409090909090909 3.5 3.2)(2.5 3.6 3.5 3.86)(3.5 3.2 5.0 3.1333333333333333)(3.5 3.86 5.0 4.325)))(10 ((2.5 3.5 3.5 3.25)(2.5 3.5 3.5 3.8)(3.5 3.25 5.0 3.1666666666666665)(3.5 3.8 5.0 4.25)))(8 ((2.7 3.5 3.5 3.3)(2.7 3.5 3.5 3.74)(3.5 3.3 5.0 3.2)(3.5 3.74 5.0 4.175)))(6 ((2.9 3.5 3.5 3.35)(2.9 3.5 3.5 3.68)(3.5 3.35 5.0 3.2333333333333334)(3.5 3.68 5.0 4.1)))(4 ((3.1 3.5 3.5 3.4)(3.1 3.5 3.5 3.62)(3.5 3.4 5.0 3.2666666666666666)(3.5 3.62 5.0 4.025)))(2 ((3.3 3.5 3.5 3.45)(3.3 3.5 3.5 3.56)(3.5 3.45 5.0 3.3)(3.5 3.56 5.0 3.95)))(0 ((3.5 3.5 5.0 3.3333333333333335)(3.5 3.5 5.0 3.875)))(-2 ((3.8 3.5 5.0 3.3666666666666667)(3.8 3.5 5.0 3.8)))(-4 ((4.1 3.5 5.0 3.4)(4.1 3.5 5.0 3.725)))(-6 ((4.4 3.5 5.0 3.433333333333333)(4.4 3.5 5.0 3.65)))(-8 ((4.7 3.5 5.0 3.466666666666667)(4.7 3.5 5.0 3.575)))))
query contourlines(test1,2) consume

#testcase query contourlines for 6x6 
#yields ((rel (tuple ((Height int)(Contour line))))((44 ((6.863636363636363 1.0 7.0 1.1666666666666667)))(42 ((6.590909090909091 1.0 7.0 1.5)(6.7 3.5 7.0 3.25)(6.7 3.5 7.0 3.611111111111111)))(40 ((6.318181818181818 1.0 7.0 1.8333333333333335)(6.4 3.5 7.0 3.0)(6.4 3.5 7.0 3.7222222222222223)))(38 ((6.045454545454546 1.0 7.0 2.1666666666666665)(6.1 3.5 7.0 2.75)(6.1 3.5 7.0 3.8333333333333335)))(36 ((5.7727272727272725 1.0 7.0 2.5)(5.8 3.5 7.0 2.5)(5.8 3.5 7.0 3.9444444444444446)))(34 ((5.5 1.0 6.75 2.5)(5.5 3.5 6.75 2.5)(5.5 3.5 7.0 4.055555555555555)))(32 ((5.318181818181818 1.0 5.5 1.2999999999999998)(5.409090909090909 3.5 5.5 3.3)(5.409090909090909 3.5 5.5 3.6666666666666665)(5.5 1.2999999999999998 6.5 2.5)(5.5 3.3 6.5 2.5)(5.5 3.6666666666666665 7.0 4.166666666666667)(5.5 5.5 7.0 5.25)(5.5 5.5 7.0 6.25)))(30 ((4.5 5.5 5.5 5.3)(4.5 5.5 5.5 6.5)(5.136363636363637 1.0 5.5 1.6)(5.318181818181818 3.5 5.5 3.1)(5.318181818181818 3.5 5.5 3.8333333333333335)(5.5 1.6 6.25 2.5)(5.5 3.1 6.25 2.5)(5.5 3.8333333333333335 7.0 4.277777777777778)(5.5 5.3 7.0 5.0)(5.5 6.5 7.0 7.0)))(28 ((4.166666666666667 5.5 4.5 5.3)(4.166666666666667 5.5 4.5 5.714285714285714)(4.5 5.3 5.5 5.1)(4.5 5.714285714285714 5.423076923076923 7.0)(4.954545454545454 1.0 5.5 1.9)(5.2272727272727275 3.5 5.5 2.9)(5.2272727272727275 3.5 5.5 4.0)(5.5 1.9 6.0 2.5)(5.5 2.9 6.0 2.5)(5.5 4.0 7.0 4.388888888888889)(5.5 5.1 7.0 4.75)))(26 ((3.8333333333333335 5.5 4.5 5.1)(3.8333333333333335 5.5 4.5 5.928571428571429)(4.5 5.1 5.5 4.9)(4.5 5.928571428571429 5.269230769230769 7.0)(4.7727272727272725 1.0 5.5 2.2)(5.136363636363637 3.5 5.5 2.7)(5.136363636363637 3.5 5.5 4.166666666666667)(5.5 2.2 5.75 2.5)(5.5 2.7 5.75 2.5)(5.5 4.166666666666667 7.0 4.5)(5.5 4.9 7.0 4.5)))(24 ((3.5 5.5 4.5 4.9)(3.5 5.5 4.5 6.142857142857143)(4.5 4.9 5.5 4.7)(4.5 6.142857142857143 5.115384615384615 7.0)(4.590909090909091 1.0 5.5 2.5)(5.045454545454545 3.5 5.5 2.5)(5.045454545454545 3.5 5.5 4.333333333333333)(5.5 4.333333333333333 6.25 4.5)(5.5 4.7 6.25 4.5)))(22 ((3.0 5.5 3.5 5.3)(3.0 5.5 3.5 5.6875)(3.5 5.3 4.5 4.7)(3.5 5.6875 4.5 6.357142857142857)(4.388888888888889 1.0 4.5 1.5)(4.5 1.5 5.0 2.5)(4.5 4.7 5.5 4.5)(4.5 6.357142857142857 4.961538461538462 7.0)(4.954545454545454 3.5 5.0 2.5)(4.954545454545454 3.5 5.5 4.5)))(20 ((2.5 5.5 3.5 5.1)(2.5 5.5 3.5 5.875)(3.5 5.1 4.5 4.5)(3.5 5.875 4.5 6.571428571428571)(4.166666666666667 1.0 4.5 2.5)(4.5 2.5 4.863636363636363 3.5)(4.5 4.5 4.863636363636363 3.5)(4.5 6.571428571428571 4.8076923076923075 7.0)))(18 ((1.0 5.5 1.5 5.5)(1.5 5.5 2.5 5.25)(1.5 5.5 2.5 6.25)(2.5 5.25 3.5 4.9)(2.5 6.25 3.5 6.0625)(3.5 2.5 3.9444444444444446 1.0)(3.5 2.5 4.5 2.75)(3.5 4.9 4.166666666666667 4.5)(3.5 6.0625 4.5 6.785714285714286)(4.166666666666667 4.5 4.5 4.25)(4.5 2.75 4.7727272727272725 3.5)(4.5 4.25 4.7727272727272725 3.5)(4.5 6.785714285714286 4.653846153846154 7.0)))(16 ((1.0 5.25 1.5 5.25)(1.0 6.25 1.5 6.25)(1.5 5.25 2.5 5.0)(1.5 6.25 2.5 7.0)(2.5 2.5 3.5 1.75)(2.5 2.5 3.5 2.75)(2.5 5.0 3.5 4.7)(2.5 7.0 3.5 6.25)(3.5 1.75 3.7222222222222223 1.0)(3.5 2.75 4.5 3.0)(3.5 4.7 3.8333333333333335 4.5)(3.5 6.25 4.5 7.0)(3.8333333333333335 4.5 4.5 4.0)(4.5 3.0 4.681818181818182 3.5)(4.5 4.0 4.681818181818182 3.5)))(14 ((1.0 2.0 1.5 2.0)(1.0 2.642857142857143 1.5 2.642857142857143)(1.0 5.0 1.5 5.0)(1.0 7.0 1.5 7.0)(1.5 2.0 2.5 1.5)(1.5 2.642857142857143 2.5 2.7222222222222223)(1.5 5.0 2.5 4.75)(2.5 1.5 3.5 1.0)(2.5 2.7222222222222223 3.5 3.0)(2.5 4.75 3.5 4.5)(2.75 7.0 3.5 6.4375)(3.5 3.0 4.5 3.25)(3.5 4.5 4.5 3.75)(3.5 6.4375 4.25 7.0)(4.5 3.25 4.590909090909091 3.5)(4.5 3.75 4.590909090909091 3.5)))(12 ((1.0 2.9285714285714284 1.5 2.9285714285714284)(1.0 4.75 1.5 4.75)(1.5 2.928571428571429 2.5 2.9444444444444446)(1.5 4.75 2.5 4.5)(2.5 2.9444444444444446 3.5 3.25)(2.5 4.5 3.5 4.0)(3.0 7.0 3.5 6.625)(3.5 3.25 4.5 3.5)(3.5 4.0 4.5 3.5)(3.5 6.625 4.0 7.0)))(10 ((1.0 3.2142857142857144 1.5 3.2142857142857144)(1.0 4.5 1.5 4.5)(1.5 3.2142857142857144 2.5 3.1666666666666665)(1.5 4.5 2.5 4.1)(2.5 3.1666666666666665 3.5 3.5)(2.5 4.1 3.5 3.5)(3.25 7.0 3.5 6.8125)(3.5 6.8125 3.75 7.0)))(8 ((1.0 3.5 1.5 3.5)(1.5 3.5 2.5 3.388888888888889)(1.5 3.5 2.5 3.7)(2.5 3.388888888888889 2.8333333333333335 3.5)(2.5 3.7 2.8333333333333335 3.5)))))
query contourlines(test2,2) consume

#testcase query contourlines for 6x6 with hole
#yields ((rel (tuple ((Height int)(Contour line))))((44 ((6.863636363636363 1.0 7.0 1.1666666666666667)))(42 ((6.590909090909091 1.0 7.0 1.5)(6.7 3.5 7.0 3.25)(6.7 3.5 7.0 3.611111111111111)))(40 ((6.318181818181818 1.0 7.0 1.8333333333333335)(6.4 3.5 7.0 3.0)(6.4 3.5 7.0 3.7222222222222223)))(38 ((6.045454545454546 1.0 7.0 2.1666666666666665)(6.1 3.5 7.0 2.75)(6.1 3.5 7.0 3.8333333333333335)))(36 ((5.7727272727272725 1.0 7.0 2.5)(5.8 3.5 7.0 2.5)(5.8 3.5 7.0 3.9444444444444446)))(34 ((5.0 3.5 5.5 3.5)(5.5 1.0 6.75 2.5)(5.5 3.5 6.75 2.5)(5.5 3.5 7.0 4.055555555555555)))(32 ((5.0 3.375 5.5 3.3)(5.0 3.6153846153846154 5.5 3.6666666666666665)(5.318181818181818 1.0 5.5 1.2999999999999998)(5.5 1.2999999999999998 6.5 2.5)(5.5 3.3 6.5 2.5)(5.5 3.6666666666666665 7.0 4.166666666666667)(5.5 5.5 7.0 5.25)(5.5 5.5 7.0 6.25)))(30 ((4.5 5.5 5.5 5.3)(4.5 5.5 5.5 6.5)(5.0 3.25 5.5 3.1)(5.0 3.730769230769231 5.5 3.8333333333333335)(5.136363636363637 1.0 5.5 1.6)(5.5 1.6 6.25 2.5)(5.5 3.1 6.25 2.5)(5.5 3.8333333333333335 7.0 4.277777777777778)(5.5 5.3 7.0 5.0)(5.5 6.5 7.0 7.0)))(28 ((4.166666666666667 5.5 4.5 5.3)(4.166666666666667 5.5 4.5 5.714285714285714)(4.5 5.3 5.5 5.1)(4.5 5.714285714285714 5.423076923076923 7.0)(4.954545454545454 1.0 5.5 1.9)(5.0 3.125 5.333333333333333 3.0)(5.0 3.8461538461538463 5.5 4.0)(5.333333333333333 3.0 5.5 2.9)(5.5 1.9 6.0 2.5)(5.5 2.9 6.0 2.5)(5.5 4.0 7.0 4.388888888888889)(5.5 5.1 7.0 4.75)))(26 ((3.8333333333333335 5.5 4.5 5.1)(3.8333333333333335 5.5 4.5 5.928571428571429)(4.5 5.1 5.5 4.9)(4.5 5.928571428571429 5.269230769230769 7.0)(4.7727272727272725 1.0 5.5 2.2)(5.0 3.0 5.5 2.7)(5.0 3.9615384615384617 5.125 4.0)(5.125 4.0 5.5 4.166666666666667)(5.5 2.2 5.75 2.5)(5.5 2.7 5.75 2.5)(5.5 4.166666666666667 7.0 4.5)(5.5 4.9 7.0 4.5)))(24 ((3.5 5.5 4.5 4.9)(3.5 5.5 4.5 6.142857142857143)(4.5 4.9 5.5 4.7)(4.5 6.142857142857143 5.115384615384615 7.0)(4.590909090909091 1.0 5.5 2.5)(4.833333333333333 3.0 5.0 2.75)(4.875 4.0 5.0 4.153846153846153)(5.0 2.75 5.5 2.5)(5.0 4.153846153846153 5.5 4.333333333333333)(5.5 4.333333333333333 6.25 4.5)(5.5 4.7 6.25 4.5)))(22 ((3.0 5.5 3.5 5.3)(3.0 5.5 3.5 5.6875)(3.5 5.3 4.5 4.7)(3.5 5.6875 4.5 6.357142857142857)(4.388888888888889 1.0 4.5 1.5)(4.5 1.5 5.0 2.5)(4.5 4.7 5.5 4.5)(4.5 6.357142857142857 4.961538461538462 7.0)(4.666666666666667 3.0 5.0 2.5)(4.6875 4.0 5.0 4.384615384615385)(5.0 4.384615384615385 5.5 4.5)))(20 ((2.5 5.5 3.5 5.1)(2.5 5.5 3.5 5.875)(3.5 5.1 4.5 4.5)(3.5 5.875 4.5 6.571428571428571)(4.166666666666667 1.0 4.5 2.5)(4.5 2.5 4.5 3.0)(4.5 4.0 4.5 4.5)(4.5 6.571428571428571 4.8076923076923075 7.0)))(18 ((1.0 5.5 1.5 5.5)(1.5 5.5 2.5 5.25)(1.5 5.5 2.5 6.25)(2.5 5.25 3.5 4.9)(2.5 6.25 3.5 6.0625)(3.5 2.5 3.9444444444444446 1.0)(3.5 2.5 4.0 2.6666666666666665)(3.5 4.9 4.166666666666667 4.5)(3.5 6.0625 4.5 6.785714285714286)(4.0 2.6666666666666665 4.25 3.0)(4.5 6.785714285714286 4.653846153846154 7.0)))(16 ((1.0 5.25 1.5 5.25)(1.0 6.25 1.5 6.25)(1.5 5.25 2.5 5.0)(1.5 6.25 2.5 7.0)(2.5 2.5 3.5 1.75)(2.5 2.5 3.5 2.75)(2.5 5.0 3.5 4.7)(2.5 7.0 3.5 6.25)(3.5 1.75 3.7222222222222223 1.0)(3.5 2.75 4.0 3.0)(3.5 4.7 3.8333333333333335 4.5)(3.5 6.25 4.5 7.0)))(14 ((1.0 2.0 1.5 2.0)(1.0 2.642857142857143 1.5 2.642857142857143)(1.0 5.0 1.5 5.0)(1.0 7.0 1.5 7.0)(1.5 2.0 2.5 1.5)(1.5 2.642857142857143 2.5 2.7222222222222223)(1.5 5.0 2.5 4.75)(2.5 1.5 3.5 1.0)(2.5 2.7222222222222223 3.5 3.0)(2.5 4.75 3.5 4.5)(2.75 7.0 3.5 6.4375)(3.5 3.0 4.0 3.1666666666666665)(3.5 6.4375 4.25 7.0)))(12 ((1.0 2.9285714285714284 1.5 2.9285714285714284)(1.0 4.75 1.5 4.75)(1.5 2.928571428571429 2.5 2.9444444444444446)(1.5 4.75 2.5 4.5)(2.5 2.9444444444444446 3.5 3.25)(2.5 4.5 3.5 4.0)(3.0 7.0 3.5 6.625)(3.5 3.25 4.0 3.3333333333333335)(3.5 6.625 4.0 7.0)))(10 ((1.0 3.2142857142857144 1.5 3.2142857142857144)(1.0 4.5 1.5 4.5)(1.5 3.2142857142857144 2.5 3.1666666666666665)(1.5 4.5 2.5 4.1)(2.5 3.1666666666666665 3.5 3.5)(2.5 4.1 3.5 3.5)(3.25 7.0 3.5 6.8125)(3.5 3.5 4.0 3.5)(3.5 6.8125 3.75 7.0)))(8 ((1.0 3.5 1.5 3.5)(1.5 3.5 2.5 3.388888888888889)(1.5 3.5 2.5 3.7)(2.5 3.388888888888889 2.8333333333333335 3.5)(2.5 3.7 2.8333333333333335 3.5)))))
query contourlines(test3,2) consume

################################################################################
# Clean up #####################################################################
################################################################################
