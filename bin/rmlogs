#!/bin/sh
#
# rmlogs [dbDir] - removes BERKELEY-DB log files
#

dbDir=../../secondo-databases;
if [ "$1" != "" ]; then
 dbDir="$1" 
fi
if [ -d $dbDir ]; then
  echo "Cleaning $dbDir ..."
else
  echo "Directory $dbDir does not exist."	
fi

cd $dbDir >& /dev/null
if [ $? -ne 0 ]; then
  echo -e "Error: Could not change to $dbDir"
else
  echo -e "Deleting unused log files in $dbDir ..."
  db_checkpoint -v1
  for file in $(db_archive); do
    echo -e "deleting $file"
    rm -f $file
  done
  echo -e "Deleting old 0tmp subdirectories ..."
  files=$(find $dbDir -name "0tmp*")
  for file in $files; do
    echo -e "deleting $file"
    rm -rf $file
  done
fi
